<link rel="import" href="oo.html">
<link rel="import" href="alert-box.html">
<link rel="import" href="modal-box.html">

<template id="my-app">
    <style>
        .success {
            background-color: #dff0d8;
            border-color: #d0e9c6;
            color: #3c763d;
        }

        .info {
            background-color: #d9edf7;
            border-color: #bcdff1;
            color: #31708f;
        }

        .warning {
            background-color: #fcf8e3;
            border-color: #faf2cc;
            color: #8a6d3b;
        }

        .danger {
            background-color: #f2dede;
            border-color: #ebcccc;
            color: #a94442;
        }
    </style>
    <alert-box class="info" dismissable>
        <strong>Success:</strong> {{state.name}} has saved the record successfully!
        <a href="{{state.link}}">Go to Gooooogle!!!!</a>
    </alert-box>
    <modal-box title="My Test Dialog" dismissable>
        <alert-box class="danger" dismissable>
        There are {{state.alertData.numErrors}} errors that you need to fix before you can {{state.alertData.verb}}!
        </alert-box>
        <button id="my-button">Test</button>

        <ul>
            <li oo-rpt="state.alertData.bookshelf[state.clicks % 3]" data-index="{{item.lastName}}">
                <strong>Last Name:</strong> {{item.lastName}}
                <br />
                <strong>First Name: </strong> {{item.firstName}}
            </li>
        </ul>
    </modal-box>
</template>

<script>
    const myAppTemplate = document.currentScript.ownerDocument.getElementById('my-app');

    customElements.define('my-app', class extends ooElement {
        constructor() {
            super(myAppTemplate);

            this.setState({
                name: 'Bob', 
                alertData: {
                    numErrors: 564,
                    verb: 'eat',
                    bookshelf: [ 
                    [
                        {
                            firstName: 'Bob',
                            lastName: 'Burlette'
                        },
                        {
                            firstName: 'John',
                            lastName: 'Smith'
                        },
                        {
                            firstName: 'Michelle',
                            lastName: 'Obama'
                        }
                        ],
                        [
                                        {
                                            firstName: 'Bilbo',
                                            lastName: 'Bagins'
                                        },
                                        {
                                            firstName: 'John',
                                            lastName: 'Williams'
                                        }
                                    ],
                                    [
                                        {
                                            firstName: 'Janis',
                                            lastName: 'Joplin'
                                        },
                                        {
                                            firstName: 'Barbara',
                                            lastName: 'Walters'
                                        },
                                        {
                                            firstName: 'Josie',
                                            lastName: 'Franks'
                                        },
                                        {
                                            firstName: 'Margaret',
                                            lastName: 'Scarrozzo'
                                        },
                                        {
                                            firstName: 'Tom',
                                            lastName: 'Petty'
                                        },
                                        {
                                            firstName: 'Jim',
                                            lastName: 'Burlette'
                                        }
                                    ]]
                },
                clicks: 0,
                link: 'https://www.google.com'
            });

            this.shadowRoot.getElementById('my-button').onclick = () => {
                this.state.clicks += 1;
                this.boundRoot.refresh();
            };

            
        }
    });

</script>